<div class="interaction-body" [style.background-color]="unitService.backgroundColor()" data-cy="interaction-body">

  <!-- menu for standalone mode -->
  @if (isStandalone) {
    <stars-standalone-menu></stars-standalone-menu>
  }

  <!-- audio controller -->
  @if (unitService.mainAudio()?.audioSource) {
    <stars-audio [audio]="unitService.mainAudio()" [firstAudioOptions]="unitService.firstAudioOptions()" [audioId]="'mainAudio'"></stars-audio>
  }

  <!-- Continue Button -->
  @if (unitService.continueButton() === "ALWAYS" ||
      (unitService.continueButton() === "ON_MAIN_AUDIO_COMPLETE" && responsesService.mainAudioComplete()) ||
      (unitService.continueButton() === "ON_AUDIO_AND_RESPONSE" && responsesService.mainAudioComplete() &&
      (responsesService.responseProgress() === "complete" || responsesService.responseProgress() === "some")) ||
      (unitService.continueButton() === "ON_VIDEO_COMPLETE" && responsesService.videoComplete()) ||
      (unitService.continueButton() === "ON_ANY_RESPONSE" &&
        (responsesService.responseProgress() === "some" || responsesService.responseProgress() === "complete")) ||
      (unitService.continueButton() === "ON_RESPONSES_COMPLETE" && responsesService.responseProgress() === "complete")
    ) {
    <stars-continue-button
      (navigate)="veronaPostService.sendVopUnitNavigationRequestedNotification('next')"></stars-continue-button>
  }

  <!-- disable interaction until complete via overlay -->
  @if (unitService.disableInteractionUntilComplete() && !responsesService.mainAudioComplete() ) {
    <div class="interaction-disabled-overlay" (click)="disabledOverlay($event)" data-cy="interaction-disabled-overlay"></div>
  }

  <!-- show ribbons when in practice mode -->
  @if (hasRibbonBars()) {
    <stars-ribbon-bar></stars-ribbon-bar>
  }

  @if (hasOpeningImage()) {
    <stars-opening-image></stars-opening-image>
  }

  <!-- interaction elements -->
  @if (unitService.interaction() === 'BUTTONS') {
    <stars-interaction-buttons class="interaction"
    [parameters]="getParametersWithFormerState()"
    (responses)="responsesService.newResponses($event)"></stars-interaction-buttons>
  } @else if (unitService.interaction() === 'DROP') {
    <stars-interaction-drop class="interaction"
      [parameters]="getParametersWithFormerState()"
      (responses)="responsesService.newResponses($event)"></stars-interaction-drop>
  } @else if (unitService.interaction() === 'WRITE') {
    <stars-interaction-write class="interaction"
      [parameters]="getParametersWithFormerState()"
      (responses)="responsesService.newResponses($event)"></stars-interaction-write>
  } @else if (unitService.interaction() === 'IMAGE_ONLY') {
    <stars-interaction-image-only class="interaction"
      [parameters]="unitService.parameters()"
      (responses)="responsesService.newResponses($event)"></stars-interaction-image-only>
  } @else if (unitService.interaction() === 'VIDEO') {
    <stars-interaction-video class="interaction"
      [parameters]="unitService.parameters()"
      (responses)="responsesService.newResponses($event)"></stars-interaction-video>
  } @else if (unitService.interaction() === 'FIND_ON_IMAGE') {
    <stars-interaction-find-on-image class="interaction"
      [parameters]="getParametersWithFormerState()"
      (responses)="responsesService.newResponses($event)"></stars-interaction-find-on-image>
  }

  <!-- lower ribbons -->
  @if (hasRibbonBars()) {
    <stars-ribbon-bar></stars-ribbon-bar>
  }
</div>
